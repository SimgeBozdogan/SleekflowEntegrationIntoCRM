<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleekflow Chat - Zoho Entegrasyonu</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar - Settings & Connection -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>‚öôÔ∏è Ayarlar</h2>
                <button class="btn-icon" id="toggleSidebar" type="button" style="cursor: pointer; z-index: 10001;">‚úï</button>
            </div>
            
            <div class="sidebar-content">
                <!-- Sleekflow Connection -->
                <div class="settings-section">
                    <h3>üì± Sleekflow</h3>
                    <div class="form-group">
                        <label>API Anahtarƒ± <span style="color: #ef4444;">*</span></label>
                        <input type="password" id="sleekflowApiKey" class="input-field" placeholder="API anahtarƒ±nƒ±zƒ± girin" required>
                        <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                            üìç Sleekflow hesabƒ±nƒ±zdan: <strong>Channels > Add integrations > API</strong> b√∂l√ºm√ºnden yeni API key olu≈üturun
                        </small>
                    </div>
                    <div class="form-group">
                        <label>Base URL (B√∂lge Se√ßin)</label>
                        <select id="sleekflowBaseUrl" class="input-field">
                            <option value="https://api.sleekflow.io">Hong Kong (Varsayƒ±lan)</option>
                            <option value="https://sleekflow-core-app-weu-production.azurewebsites.net">West Europe</option>
                            <option value="https://sleekflow-core-app-eus-production.azurewebsites.net">United States</option>
                            <option value="https://sleekflow-core-app-seas-production.azurewebsites.net">Singapore</option>
                            <option value="https://sleekflow-core-app-uaen-production.azurewebsites.net">UAE North</option>
                        </select>
                        <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                            ‚ö†Ô∏è Sleekflow hesabƒ±nƒ±zƒ±n hangi b√∂lgede olduƒüunu se√ßin (West Europe olabilir)
                        </small>
                    </div>
                    <button class="btn btn-primary btn-block" id="connectSleekflow">Baƒülan</button>
                </div>

                <!-- Zoho Connection -->
                <div class="settings-section">
                    <h3>üìä Zoho</h3>
                    <div class="form-group">
                        <label>Client ID</label>
                        <input type="text" id="zohoClientId" class="input-field" placeholder="Client ID">
                    </div>
                    <div class="form-group">
                        <label>Client Secret</label>
                        <input type="password" id="zohoClientSecret" class="input-field" placeholder="Client Secret">
                    </div>
                    <div class="form-group">
                        <label>Redirect URI</label>
                        <input type="text" id="zohoRedirectUri" class="input-field" value="http://localhost:3000/callback">
                    </div>
                    <div class="form-group">
                        <label>B√∂lge</label>
                        <select id="zohoRegion" class="input-field">
                            <option value="com">Zoho.com (Global)</option>
                            <option value="eu">Zoho.eu (Europe)</option>
                            <option value="in">Zoho.in (India)</option>
                        </select>
                    </div>
                    <button class="btn btn-primary btn-block" id="connectZoho">Baƒülan</button>
                    <button class="btn btn-secondary btn-block" id="testZoho" style="margin-top: 10px;">Test Et</button>
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <div class="main-area">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <button class="btn-icon" id="openSidebar" type="button">‚ò∞</button>
                    <h1>Sleekflow Inbox</h1>
                </div>
                <div class="top-bar-right">
                    <button class="btn-icon" id="refreshConversations" title="Yenile">üîÑ</button>
                </div>
            </header>

            <!-- Chat Layout -->
            <div class="chat-layout">
                <!-- Conversations List -->
                <div class="conversations-panel" id="conversationsPanel">
                    <div class="conversations-header">
                        <h2>Konu≈ümalar</h2>
                        <select id="channelFilter" class="sender-select" title="Kanal Filtrele">
                            <option value="">T√ºm Kanallar</option>
                            <option value="whatsapp">WhatsApp</option>
                            <option value="instagram">Instagram</option>
                            <option value="facebook">Facebook</option>
                            <option value="sms">SMS</option>
                            <option value="line">LINE</option>
                            <option value="wechat">WeChat</option>
                            <option value="web">Web</option>
                        </select>
                        <input type="text" id="searchConversations" class="search-input" placeholder="üîç Ara...">
                    </div>
                    
                    <!-- Lead filter info bar -->
                    <div id="leadFilterInfo" class="lead-filter-info" style="display:none;"></div>
                    
                    <div class="conversations-list" id="conversationsList">
                        <div class="empty-state">
                            <p>üì≠ Hen√ºz konu≈üma yok</p>
                            <p class="empty-hint">Sleekflow'a baƒülanƒ±n ve konu≈ümalarƒ± g√∂r√ºnt√ºleyin</p>
                        </div>
                    </div>
                </div>

                <!-- Chat View -->
                <div class="chat-view" id="chatView">
                    <div class="chat-empty">
                        <div class="empty-icon">üí¨</div>
                        <h2>Bir konu≈üma se√ßin</h2>
                        <p>Sol taraftan bir konu≈üma se√ßerek mesajlarƒ± g√∂r√ºnt√ºleyin</p>
                    </div>

                    <!-- Active Chat -->
                    <div class="chat-active" id="chatActive" style="display: none;">
                        <!-- Chat Header -->
                        <div class="chat-header">
                            <div class="chat-header-info">
                                <div class="chat-avatar" id="chatAvatar">üë§</div>
                                <div>
                                    <h3 id="chatContactName">ƒ∞sim</h3>
                                    <span class="chat-meta" id="chatMeta">Durum</span>
                                </div>
                            </div>
                        </div>

                        <!-- Messages Area -->
                        <div class="messages-area" id="messagesArea">
                            <div class="messages-list" id="messagesList">
                                <!-- Messages will be inserted here -->
                            </div>
                        </div>

                        <!-- Message Input -->
                        <div class="message-input-area">
                            <div class="message-input-wrapper">
                                <input 
                                    type="file" 
                                    id="fileInput" 
                                    class="file-input" 
                                    multiple
                                    accept="image/*,video/*,audio/*,.pdf"
                                    style="display: none;"
                                >
                                <button class="btn btn-icon" id="attachFile" title="Dosya ekle" style="margin-right: 5px; padding: 8px 12px;">üìé</button>
                                <input 
                                    type="text" 
                                    id="messageInput" 
                                    class="message-input" 
                                    placeholder="Mesaj yazƒ±n..."
                                    disabled
                                >
                                <button class="btn btn-primary" id="sendMessage" disabled>G√∂nder</button>
                            </div>
                            <div id="selectedFilesContainer" class="selected-files-container" style="display: none;">
                                <!-- Se√ßilen dosyalar burada g√∂sterilecek -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="overlay" id="loadingOverlay" style="display: none;">
        <div class="spinner"></div>
        <p>Y√ºkleniyor...</p>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // Basit sidebar kontrol fonksiyonlarƒ±

        function openSidebarNow() {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) {
                console.error('‚ùå #sidebar bulunamadƒ±');
                return;
            }
            sidebar.classList.add('open');
            document.body.style.overflow = 'hidden';
            console.log('‚úÖ Sidebar A√áILDI');
        }

        function closeSidebarNow() {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            sidebar.classList.remove('open');
            document.body.style.overflow = '';
            console.log('‚úÖ Sidebar KAPATILDI');
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (!sidebar) return;

            const isOpen = sidebar.classList.contains('open');
            if (isOpen) {
                closeSidebarNow();
            } else {
                openSidebarNow();
            }
        }

        // Global eri≈üim (HTML'de onclick kullanƒ±yorsan)
        window.openSidebarNow = openSidebarNow;
        window.closeSidebarNow = closeSidebarNow;
        window.toggleSidebar = toggleSidebar;

        // Butonlara event baƒüla
        document.addEventListener('DOMContentLoaded', () => {
            const openBtn = document.getElementById('openSidebar');
            const closeBtn = document.getElementById('toggleSidebar'); // X butonu

            if (openBtn) {
                openBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    toggleSidebar();
                });
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    toggleSidebar();
                });
            }
        });
    </script>
    <script src="app.js?v=48"></script>
</body>
</html>
